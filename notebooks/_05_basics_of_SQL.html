
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Basics of SQL &#8212; Full Stack Quantitative Finance</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=7a7908ec"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/_05_basics_of_SQL';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 4: Generating Reports, featuring Jupyter Notebooks and LaTeX" href="../overview_w4.html" />
    <link rel="prev" title="Project Structure" href="../Week3/project_structure.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>   
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Full Stack Quantitative Finance - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Full Stack Quantitative Finance - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Full Stack Quantitative Finance
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Course Syllabus: FINM 32900, Winter 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Appendix</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures 📖</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w1.html">Week 1: GitHub, GitHub Classroom, and Virtual Environments</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1/what_is_this_course_about.html">What is Full Stack Quantitative Finance? Why This Course?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/reproducible_analytical_pipelines.html">What are Reproducible Analytical Pipelines?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/case_study_reproducibility_in_finance.html">Case Study: Is There A Reproducibility Crisis In Finance?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/virtual_environments.html">Virtual Environments</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w2.html">Week 2: Env Files and Secrets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week2/WRDS_intro_and_web_queries.html">Introduction to WRDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="_01_wrds_python_package.html">Example: Connecting to the WRDS Platform With Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week2/env_files.html">Env Files, Secrets, and the Separations of Settings from Code</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../overview_w3.html">Week 3: Task Runners, Automating Queries, and the Basics of SQL</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Week3/what_is_a_task_runner.html">What is a build system or task runner?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week3/project_structure.html">Project Structure</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Basics of SQL</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w4.html">Week 4: Generating Reports, featuring Jupyter Notebooks and LaTeX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week4/reports_with_jupyter_notebooks.html">Reports with Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/intro_to_LaTeX.html">Introduction to LaTeX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/latex_essentials.html">LaTeX Essentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w5.html">Week 5: Unit Tests and Documentation with Sphinx</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week5/sphinx.html">Sphinx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week5/unit_tests.html">Unit Tests</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w6.html">Week 6: Python Package Development and Social Coding with GitHub</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week6/GitHub_pull_requests.html">GitHub Issues and Pull Requests: Enhancing Collaborative Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week6/python_packaging_with_hatch.html">Writing and Publishing Your Own Python Packages</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w7.html">Week 7: Bloomberg and LSEG Datastream</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week7/bloomberg_terminal.html">The Bloomberg Terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week7/LSEG_datastream.html">LSEG Datastream</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w8.html">Week 8: Web Authentication and Authorization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_01_corporate_hedging.html">Case Study: Hedging Oil Price Exposure As An E&amp;P</a></li>
<li class="toctree-l2"><a class="reference internal" href="_02_spx_hedging.html">Case Study: Hedging A Long-Only SPX Portfolio With Costless Collars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week8/web_authentication.html">Web Authentication and Authorization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../overview_w9.html">Week 9: GitHub Actions and Publishing a Live Dashboard</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week9/github_actions_interactive_dashboard.html">Creating a Live Dashboard Example with GitHub Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/intro_to_LaTeX.html">Introduction to LaTeX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/latex_essentials.html">LaTeX Essentials</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework 📝</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../HW0.html">Homework 0</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../HW1.html">Homework 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../HW1/case_study_atlanta_fed_wage_growth_tracker.html">Case Study: Atlanta Fed Wage Growth Tracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="_01_wage_growth_during_the_recession.html">HW Guide: Wage Growth During the Recession</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../HW2.html">Homework 2</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_02_CRSP_market_index.html">HW Guide Part A: CRSP Market Returns Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="_03_SP500_constituents_and_index.html">HW Guide Part B: Reconstructing the S&amp;P 500 Index</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../HW3.html">Homework 3</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_04_Fama_French_1993.html">HW Guide Part A: Replicate Fama-French 1993</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../HW4.html">Homework 4</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_01_CRSP_treasury_overview.html">CRSP Treasury Data Oveview</a></li>
<li class="toctree-l2"><a class="reference internal" href="_02_replicate_GSW2005.html">Replicating the Gürkaynak, Sack, and Wright (2006) Treasury Yield Curve</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../HW5.html">Homework 5</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../final_project.html">Final Project</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../FinalProject/final_project_rubric.html">Final Project Instructions and Rubric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FinalProject/potential_final_projects.html">List of Potential Final Projects</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jmbejara/blank_project" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jmbejara/blank_project/issues/new?title=Issue%20on%20page%20%2Fnotebooks/_05_basics_of_SQL.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/_05_basics_of_SQL.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Basics of SQL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-sql">What is SQL?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-sql-so-useful">Why is SQL so useful?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-are-relational-databases-so-popular">Why are relational databases so popular?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-sql-syntax">Basic SQL Syntax</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-data">1. <strong>Selecting Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">2. <strong>Filtering Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-tables">3. <strong>Joining Tables</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregating-data">4. <strong>Aggregating Data</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-queries-in-the-repository">Example Queries in the Repository</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-from-pull-crsp-stock-py">1. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_CRSP_stock.py</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-from-pull-crsp-compustat-py">2. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_CRSP_Compustat.py</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-from-pull-sp500-constituents-py">3. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_SP500_constituents.py</span></code></strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-why-are-databases-so-important">Appendix: Why are databases so important?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#efficient-data-management-and-querying">1. <strong>Efficient Data Management and Querying</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-integrity">2. <strong>Data Integrity</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalability">3. <strong>Scalability</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concurrency-and-multi-user-access">4. <strong>Concurrency and Multi-User Access</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-security">5. <strong>Data Security</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-redundancy-and-backup">6. <strong>Data Redundancy and Backup</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-relationships-and-complex-structures">7. <strong>Data Relationships and Complex Structures</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalable-data-analytics">8. <strong>Scalable Data Analytics</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-consistency-across-applications">9. <strong>Data Consistency Across Applications</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regulatory-compliance">10. <strong>Regulatory Compliance</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-table-database-vs-plain-files">Summary Table: Database vs. Plain Files</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <section class="tex2jax_ignore mathjax_ignore" id="basics-of-sql">
<h1>Basics of SQL<a class="headerlink" href="#basics-of-sql" title="Link to this heading">#</a></h1>
<p>Structured Query Language (SQL) is a domain-specific programming language designed for managing and querying data in relational database systems. Relational databases organize data into tables, which consist of rows (records) and columns (attributes). SQL is the standard language used for interacting with these databases, and it plays a fundamental role in finance and data analysis, particularly when working with large datasets.</p>
<p>This lesson provides a brief introduction to SQL concepts that are helpful for understanding the scripts used in the homework, such as <code class="docutils literal notranslate"><span class="pre">pull_CRSP_stock.py</span></code>, <code class="docutils literal notranslate"><span class="pre">pull_CRSP_Compustat.py</span></code>, and <code class="docutils literal notranslate"><span class="pre">pull_SP500_constituents.py</span></code>. The focus will be on the basic SQL commands needed to query and extract data from databases such as the CRSP and Compustat datasets available through the WRDS platform.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<section id="what-is-sql">
<h3>What is SQL?<a class="headerlink" href="#what-is-sql" title="Link to this heading">#</a></h3>
<p>SQL is used to perform the following operations on relational databases:</p>
<ul class="simple">
<li><p><strong>Querying data</strong>: Extract specific information using the <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> statement.</p></li>
<li><p><strong>Filtering data</strong>: Use <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> conditions to retrieve only relevant records.</p></li>
<li><p><strong>Joining tables</strong>: Combine data from multiple tables using <code class="docutils literal notranslate"><span class="pre">JOIN</span></code>.</p></li>
<li><p><strong>Sorting and aggregating data</strong>: Use functions such as <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code>, <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code>, and aggregate functions (e.g., <code class="docutils literal notranslate"><span class="pre">SUM</span></code>, <code class="docutils literal notranslate"><span class="pre">AVG</span></code>).</p></li>
</ul>
<p>Relational databases are ubiquitous in the finance industry due to their ability to handle structured data efficiently. SQL is widely used because of its simplicity, flexibility, and ability to process complex queries across large datasets.</p>
</section>
<section id="why-is-sql-so-useful">
<h3>Why is SQL so useful?<a class="headerlink" href="#why-is-sql-so-useful" title="Link to this heading">#</a></h3>
<p>SQL is incredibly useful because it provides a powerful, standardized language for efficiently querying, managing, and analyzing structured data stored in relational databases. It allows users to retrieve specific information, filter records, join tables, and perform complex aggregations with minimal effort.</p>
</section>
<section id="why-are-relational-databases-so-popular">
<h3>Why are relational databases so popular?<a class="headerlink" href="#why-are-relational-databases-so-popular" title="Link to this heading">#</a></h3>
<p>Relational databases are popular because they organize data into tables with defined relationships, ensuring consistency, integrity, and scalability. They also support features like indexing for fast access, concurrency for multi-user operations, and robust security mechanisms. These capabilities make relational databases and SQL indispensable for industries that rely on large, structured datasets, such as finance, healthcare, and e-commerce.</p>
<p>Furthermore, large companies use databases because they efficiently handle large-scale, complex, and sensitive data. Databases enable fast querying, filtering, and joining of data, which is critical for managing and analyzing structured datasets. They ensure data integrity through constraints and transactions, support multiple concurrent users, and provide robust security features like encryption and access control. Databases also automate backups, ensure data redundancy, and comply with regulatory requirements through logging and retention policies. Unlike plain files, databases are scalable, reliable, and integrate seamlessly with analytics tools, making them essential for modern enterprises.</p>
<p>As an example, the acronym “ACID” is commonly used to describe the properties of a database system. An “ACID database” refers to a database that adheres to the ACID properties, which stand for “Atomicity, Consistency, Isolation, and Durability” - essentially meaning that any transaction within the database will be completed fully and reliably, ensuring data integrity even in the face of errors or system failures; it’s a standard for ensuring data consistency in database operations, particularly important for applications requiring high reliability like financial systems.</p>
</section>
</section>
<section id="basic-sql-syntax">
<h2>Basic SQL Syntax<a class="headerlink" href="#basic-sql-syntax" title="Link to this heading">#</a></h2>
<p>To understand the SQL queries used in the provided scripts, it is important to review the following basic concepts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">wrds</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">config</span>
<span class="n">WRDS_USERNAME</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s2">&quot;WRDS_USERNAME&quot;</span><span class="p">)</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">wrds</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">wrds_username</span><span class="o">=</span><span class="n">WRDS_USERNAME</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading library list...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Done
</pre></div>
</div>
</div>
</div>
<section id="selecting-data">
<h3>1. <strong>Selecting Data</strong><a class="headerlink" href="#selecting-data" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> statement retrieves specific columns from a table.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">column1</span><span class="p">,</span><span class="w"> </span><span class="n">column2</span>
<span class="k">FROM</span><span class="w"> </span><span class="k">table_name</span><span class="p">;</span>
</pre></div>
</div>
<p>Example:</p>
<p>This query retrieves the <code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">permno</span></code> (unique stock identifier), and <code class="docutils literal notranslate"><span class="pre">ret</span></code> (return) columns from the <code class="docutils literal notranslate"><span class="pre">crsp.msf</span></code> table. Note that the <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> clause is used to limit the number of rows returned to 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">raw_sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT date, permno, ret</span>
<span class="s2">FROM crsp.msf</span>
<span class="s2">LIMIT 10;</span>
<span class="s2">;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>permno</th>
      <th>ret</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1985-12-31</td>
      <td>10000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1986-01-31</td>
      <td>10000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1986-02-28</td>
      <td>10000</td>
      <td>-0.257143</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1986-03-31</td>
      <td>10000</td>
      <td>0.365385</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1986-04-30</td>
      <td>10000</td>
      <td>-0.098592</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1986-05-30</td>
      <td>10000</td>
      <td>-0.222656</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1986-06-30</td>
      <td>10000</td>
      <td>-0.005025</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1986-07-31</td>
      <td>10000</td>
      <td>-0.080808</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1986-08-29</td>
      <td>10000</td>
      <td>-0.615385</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1986-09-30</td>
      <td>10000</td>
      <td>-0.057143</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="filtering-data">
<h3>2. <strong>Filtering Data</strong><a class="headerlink" href="#filtering-data" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause is used to filter rows that meet specific conditions.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">column1</span><span class="p">,</span><span class="w"> </span><span class="n">column2</span>
<span class="k">FROM</span><span class="w"> </span><span class="k">table_name</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">condition</span><span class="p">;</span>
</pre></div>
</div>
<p>Example:</p>
<p>This query retrieves data for stocks within the specified date range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">raw_sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT date, permno, ret</span>
<span class="s2">FROM crsp.msf</span>
<span class="s2">WHERE date BETWEEN &#39;2023-01-01&#39; AND &#39;2023-12-31&#39;</span>
<span class="s2">LIMIT 10;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>permno</th>
      <th>ret</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2023-01-31</td>
      <td>10026</td>
      <td>-0.042816</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023-01-31</td>
      <td>10028</td>
      <td>0.269924</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2023-01-31</td>
      <td>10032</td>
      <td>-0.067425</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2023-01-31</td>
      <td>10044</td>
      <td>-0.056439</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2023-01-31</td>
      <td>10065</td>
      <td>0.070151</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2023-01-31</td>
      <td>10066</td>
      <td>0.141256</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2023-01-31</td>
      <td>10104</td>
      <td>0.086127</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2023-01-31</td>
      <td>10107</td>
      <td>0.033317</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2023-01-31</td>
      <td>10113</td>
      <td>0.053899</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2023-01-31</td>
      <td>10138</td>
      <td>0.067944</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="joining-tables">
<h3>3. <strong>Joining Tables</strong><a class="headerlink" href="#joining-tables" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">JOIN</span></code> clause combines data from multiple tables based on a common column.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">column1</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">column2</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">table1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t1</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">table2</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t2</span>
<span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">common_column</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">common_column</span><span class="p">;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">raw_sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT msf.date, msf.permno, msf.ret, msenames.comnam</span>
<span class="s2">FROM crsp.msf AS msf</span>
<span class="s2">    LEFT JOIN </span>
<span class="s2">        crsp.msenames as msenames</span>
<span class="s2">    ON </span>
<span class="s2">        msf.permno = msenames.permno AND</span>
<span class="s2">        msenames.namedt &lt;= msf.date AND</span>
<span class="s2">        msf.date &lt;= msenames.nameendt</span>
<span class="s2">LIMIT 10;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>permno</th>
      <th>ret</th>
      <th>comnam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1985-12-31</td>
      <td>10000</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1986-01-31</td>
      <td>10000</td>
      <td>NaN</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1986-02-28</td>
      <td>10000</td>
      <td>-0.257143</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1986-03-31</td>
      <td>10000</td>
      <td>0.365385</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1986-04-30</td>
      <td>10000</td>
      <td>-0.098592</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1986-05-30</td>
      <td>10000</td>
      <td>-0.222656</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1986-06-30</td>
      <td>10000</td>
      <td>-0.005025</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1986-07-31</td>
      <td>10000</td>
      <td>-0.080808</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1986-08-29</td>
      <td>10000</td>
      <td>-0.615385</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1986-09-30</td>
      <td>10000</td>
      <td>-0.057143</td>
      <td>OPTIMUM MANUFACTURING INC</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This query demonstrates a common pattern in financial data analysis - joining historical stock returns with company names. Let’s break it down:</p>
<ul class="simple">
<li><p>The Main Table (crsp.msf):</p>
<ul>
<li><p>msf is the CRSP Monthly Stock File containing stock returns</p></li>
<li><p>We alias it as <code class="docutils literal notranslate"><span class="pre">msf</span></code> for cleaner syntax</p></li>
<li><p>Contains columns like <code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">permno</span></code> (stock identifier), and <code class="docutils literal notranslate"><span class="pre">ret</span></code> (returns)</p></li>
</ul>
</li>
<li><p>The Name History Table (crsp.msenames):</p>
<ul>
<li><p>Contains historical company names</p></li>
<li><p>We alias it as <code class="docutils literal notranslate"><span class="pre">msenames</span></code></p></li>
<li><p>Has columns like <code class="docutils literal notranslate"><span class="pre">permno</span></code>, <code class="docutils literal notranslate"><span class="pre">comnam</span></code> (company name), <code class="docutils literal notranslate"><span class="pre">namedt</span></code> (start date), and <code class="docutils literal notranslate"><span class="pre">nameendt</span></code> (end date)</p></li>
</ul>
</li>
<li><p>The JOIN Conditions:</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ON</span><span class="w"> </span>
<span class="w">    </span><span class="n">msf</span><span class="p">.</span><span class="n">permno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msenames</span><span class="p">.</span><span class="n">permno</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span>
<span class="w">    </span><span class="n">msenames</span><span class="p">.</span><span class="n">namedt</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span>
<span class="w">    </span><span class="n">msf</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">msenames</span><span class="p">.</span><span class="n">nameendt</span>
</pre></div>
</div>
<p>This is a complex join with three conditions:</p>
<ul class="simple">
<li><p>Match the stock identifier (permno)</p></li>
<li><p>Ensure the stock date is after the name’s start date (namedt)</p></li>
<li><p>Ensure the stock date is before the name’s end date (nameendt){note}</p></li>
</ul>
<p>Example:</p>
<p>If a company changed its name from “Old Corp” to “New Corp” on 2020-01-01:</p>
<ul class="simple">
<li><p>Returns before 2020-01-01 will match with “Old Corp”</p></li>
<li><p>Returns after 2020-01-01 will match with “New Corp”4.</p></li>
</ul>
<p><strong>Why LEFT JOIN?</strong></p>
<ul class="simple">
<li><p>LEFT JOIN keeps all rows from msf even if there’s no matching name</p></li>
<li><p>This prevents losing return data just because we can’t find a company nameThis query structure is common in financial databases where entities (like company names) change over time and we need to match historical data correctly.</p></li>
</ul>
</section>
<section id="aggregating-data">
<h3>4. <strong>Aggregating Data</strong><a class="headerlink" href="#aggregating-data" title="Link to this heading">#</a></h3>
<p>Aggregate functions summarize data (e.g., calculate totals, averages).</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">column</span><span class="p">,</span><span class="w"> </span><span class="n">aggregate_function</span><span class="p">(</span><span class="k">column</span><span class="p">)</span>
<span class="k">FROM</span><span class="w"> </span><span class="k">table_name</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">column</span><span class="p">;</span>
</pre></div>
</div>
<p>Example:</p>
<p>This query calculates the average return for each date in the <code class="docutils literal notranslate"><span class="pre">crsp.msf</span></code> table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">raw_sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT date, AVG(ret) AS avg_return</span>
<span class="s2">FROM crsp.msf</span>
<span class="s2">GROUP BY date</span>
<span class="s2">LIMIT 10;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>avg_return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1925-12-31</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1926-01-30</td>
      <td>0.023174</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1926-02-27</td>
      <td>-0.052812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1926-03-31</td>
      <td>-0.097510</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1926-04-30</td>
      <td>0.032257</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1926-05-28</td>
      <td>0.001172</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1926-06-30</td>
      <td>0.048846</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1926-07-31</td>
      <td>0.012747</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1926-08-31</td>
      <td>0.030459</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1926-09-30</td>
      <td>-0.006617</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="example-queries-in-the-repository">
<h2>Example Queries in the Repository<a class="headerlink" href="#example-queries-in-the-repository" title="Link to this heading">#</a></h2>
<section id="query-from-pull-crsp-stock-py">
<h3>1. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_CRSP_stock.py</span></code></strong><a class="headerlink" href="#query-from-pull-crsp-stock-py" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pull_CRSP_monthly_file</span></code> function includes an SQL query to pull CRSP monthly stock data. Here is an excerpt of the query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="nb">date</span><span class="p">,</span>
<span class="w">    </span><span class="n">msf</span><span class="p">.</span><span class="n">permno</span><span class="p">,</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="n">permco</span><span class="p">,</span><span class="w"> </span><span class="n">shrcd</span><span class="p">,</span><span class="w"> </span><span class="n">exchcd</span><span class="p">,</span><span class="w"> </span><span class="n">comnam</span><span class="p">,</span><span class="w"> </span><span class="n">shrcls</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">retx</span><span class="p">,</span><span class="w"> </span><span class="n">dlret</span><span class="p">,</span><span class="w"> </span><span class="n">dlretx</span><span class="p">,</span><span class="w"> </span><span class="n">dlstcd</span><span class="p">,</span>
<span class="w">    </span><span class="n">prc</span><span class="p">,</span><span class="w"> </span><span class="n">altprc</span><span class="p">,</span><span class="w"> </span><span class="n">vol</span><span class="p">,</span><span class="w"> </span><span class="n">shrout</span><span class="p">,</span><span class="w"> </span><span class="n">cfacshr</span><span class="p">,</span><span class="w"> </span><span class="n">cfacpr</span><span class="p">,</span>
<span class="w">    </span><span class="n">naics</span><span class="p">,</span><span class="w"> </span><span class="n">siccd</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">crsp</span><span class="p">.</span><span class="n">msf</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">msf</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">crsp</span><span class="p">.</span><span class="n">msenames</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">msenames</span>
<span class="k">ON</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="n">permno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msenames</span><span class="p">.</span><span class="n">permno</span>
<span class="k">WHERE</span><span class="w"> </span>
<span class="w">    </span><span class="n">msf</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;{start_date}&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;{end_date}&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span>
<span class="w">    </span><span class="n">msenames</span><span class="p">.</span><span class="n">shrcd</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">,</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w"> </span><span class="mi">71</span><span class="p">,</span><span class="w"> </span><span class="mi">73</span><span class="p">);</span>
</pre></div>
</div>
<p>This query pulls monthly stock data from CRSP (Center for Research in Security Prices) with several specific purposes:</p>
<ol class="arabic simple">
<li><p>Core Stock Data Selection:</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="nb">date</span><span class="p">,</span>
<span class="w">    </span><span class="n">msf</span><span class="p">.</span><span class="n">permno</span><span class="p">,</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="n">permco</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Stock identifiers</span>
<span class="w">    </span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">retx</span><span class="p">,</span><span class="w">               </span><span class="c1">-- Returns (with/without distributions)</span>
<span class="w">    </span><span class="n">prc</span><span class="p">,</span><span class="w"> </span><span class="n">altprc</span><span class="p">,</span><span class="w"> </span><span class="n">vol</span><span class="p">,</span><span class="w">       </span><span class="c1">-- Price and volume data</span>
<span class="w">    </span><span class="n">shrout</span><span class="p">,</span><span class="w"> </span><span class="n">cfacshr</span><span class="p">,</span><span class="w"> </span><span class="n">cfacpr</span><span class="w"> </span><span class="c1">-- Share data and adjustment factors</span>
</pre></div>
</div>
<p>These fields are essential for calculating stock returns and market capitalizations.</p>
<ol class="arabic simple" start="2">
<li><p>Company Information Linking:</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">FROM</span><span class="w"> </span><span class="n">crsp</span><span class="p">.</span><span class="n">msf</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">msf</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">crsp</span><span class="p">.</span><span class="n">msenames</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">msenames</span>
<span class="k">ON</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="n">permno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msenames</span><span class="p">.</span><span class="n">permno</span><span class="w"> </span><span class="k">AND</span>
<span class="w">    </span><span class="n">msenames</span><span class="p">.</span><span class="n">namedt</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="k">AND</span>
<span class="w">    </span><span class="n">msf</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">msenames</span><span class="p">.</span><span class="n">nameendt</span>
</pre></div>
</div>
<p>This join handles company name changes over time by:</p>
<ul class="simple">
<li><p>Matching stock identifiers (permno)</p></li>
<li><p>Ensuring the date falls within the valid period for each company name</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Delisting Information:</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">crsp</span><span class="p">.</span><span class="n">msedelist</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">msedelist</span>
<span class="k">ON</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="n">permno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msedelist</span><span class="p">.</span><span class="n">permno</span><span class="w"> </span><span class="k">AND</span>
<span class="w">    </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">msf</span><span class="p">.</span><span class="nb">date</span><span class="p">)::</span><span class="nb">date</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">msedelist</span><span class="p">.</span><span class="n">dlstdt</span><span class="p">)::</span><span class="nb">date</span>
</pre></div>
</div>
<p>This join captures when companies are delisted from exchanges, which is crucial for:</p>
<ul class="simple">
<li><p>Accurate return calculations</p></li>
<li><p>Avoiding survivorship bias in the data</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Data Filtering:</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">WHERE</span><span class="w"> </span>
<span class="w">    </span><span class="n">msf</span><span class="p">.</span><span class="nb">date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;{start_date}&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;{end_date}&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span>
<span class="w">    </span><span class="n">msenames</span><span class="p">.</span><span class="n">shrcd</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">,</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w"> </span><span class="mi">71</span><span class="p">,</span><span class="w"> </span><span class="mi">73</span><span class="p">);</span>
</pre></div>
</div>
<p>This filters:</p>
<ul class="simple">
<li><p>Specific date range</p></li>
<li><p>Specific share codes (e.g., 10-11 for ordinary common shares)</p></li>
<li><p><strong>Key Concepts</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">JOIN</span></code> ensures all rows from the <code class="docutils literal notranslate"><span class="pre">crsp.msf</span></code> table are returned, even if there is no match in the <code class="docutils literal notranslate"><span class="pre">crsp.msenames</span></code> table.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause filters data for specific date ranges and share codes (<code class="docutils literal notranslate"><span class="pre">shrcd</span></code>).</p></li>
</ul>
</li>
</ul>
</section>
<section id="query-from-pull-crsp-compustat-py">
<h3>2. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_CRSP_Compustat.py</span></code></strong><a class="headerlink" href="#query-from-pull-crsp-compustat-py" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pull_CRSP_Comp_Link_Table</span></code> function extracts the link table between CRSP and Compustat:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="n">gvkey</span><span class="p">,</span><span class="w"> </span><span class="n">lpermno</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">permno</span><span class="p">,</span><span class="w"> </span><span class="n">linktype</span><span class="p">,</span><span class="w"> </span><span class="n">linkprim</span><span class="p">,</span><span class="w"> </span><span class="n">linkdt</span><span class="p">,</span><span class="w"> </span><span class="n">linkenddt</span>
<span class="k">FROM</span><span class="w"> </span>
<span class="w">    </span><span class="n">crsp</span><span class="p">.</span><span class="n">ccmxpf_linktable</span>
<span class="k">WHERE</span><span class="w"> </span>
<span class="w">    </span><span class="n">substr</span><span class="p">(</span><span class="n">linktype</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span>
<span class="w">    </span><span class="p">(</span><span class="n">linkprim</span><span class="w"> </span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">linkprim</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Key Concepts</strong>:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">substr(linktype,1,1)='L'</span></code> condition ensures only “Link” records are retrieved.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">linkprim</span></code> condition ensures that only primary or secondary links are included.</p></li>
</ul>
</li>
</ul>
</section>
<section id="query-from-pull-sp500-constituents-py">
<h3>3. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_SP500_constituents.py</span></code></strong><a class="headerlink" href="#query-from-pull-sp500-constituents-py" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pull_constituents</span></code> function extracts S&amp;P 500 constituent data:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w">  </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">crsp_m_indexes</span><span class="p">.</span><span class="n">dsp500list_v2</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Key Concepts</strong>:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span></code> retrieves all columns from the <code class="docutils literal notranslate"><span class="pre">dsp500list_v2</span></code> table.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="appendix-why-are-databases-so-important">
<h2>Appendix: Why are databases so important?<a class="headerlink" href="#appendix-why-are-databases-so-important" title="Link to this heading">#</a></h2>
<p>Large companies store data in databases rather than in plain files for several key reasons related to <strong>data organization, scalability, security, efficiency, and reliability</strong>. Below is a detailed breakdown of why databases are preferred in enterprise settings:</p>
<section id="efficient-data-management-and-querying">
<h3>1. <strong>Efficient Data Management and Querying</strong><a class="headerlink" href="#efficient-data-management-and-querying" title="Link to this heading">#</a></h3>
<p>Databases use structured query languages (e.g., SQL) to efficiently retrieve, filter, and manipulate data. This is not practical with plain files.</p>
<ul class="simple">
<li><p><strong>Indexed Searching</strong>: Databases use indexes to locate data quickly, which is much faster than searching through plain files line-by-line.</p></li>
<li><p><strong>Complex Queries</strong>: Relational databases allow users to run complex queries (e.g., <code class="docutils literal notranslate"><span class="pre">JOIN</span></code>, <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code>) to extract insights from large datasets, whereas with plain files, this would require extensive custom programming.</p></li>
</ul>
<p><strong>Example</strong>: A financial institution analyzing stock returns for a portfolio over multiple years can use a database query to join data across tables in seconds, while processing plain files might take significantly longer.</p>
</section>
<section id="data-integrity">
<h3>2. <strong>Data Integrity</strong><a class="headerlink" href="#data-integrity" title="Link to this heading">#</a></h3>
<p>Databases ensure data consistency and accuracy through mechanisms such as:</p>
<ul class="simple">
<li><p><strong>Constraints</strong>: Enforce rules, such as ensuring no duplicate stock identifiers (<code class="docutils literal notranslate"><span class="pre">permno</span></code>), or that all transactions have valid dates.</p></li>
<li><p><strong>Transactions</strong>: Ensure multiple operations (e.g., updating stock prices and their related indices) are performed reliably using the ACID (Atomicity, Consistency, Isolation, Durability) principles. Plain files lack this reliability.</p></li>
</ul>
<p><strong>Example</strong>: If an update fails halfway through in a plain file, the file could become corrupted, but databases can roll back the transaction to maintain integrity.</p>
</section>
<section id="scalability">
<h3>3. <strong>Scalability</strong><a class="headerlink" href="#scalability" title="Link to this heading">#</a></h3>
<p>Databases are designed to handle large-scale data storage and access needs, which are common in large companies.</p>
<ul class="simple">
<li><p><strong>Horizontal and Vertical Scaling</strong>: Modern databases can scale to store terabytes or even petabytes of data and handle thousands of concurrent users.</p></li>
<li><p><strong>Efficient Storage</strong>: Databases store data efficiently using techniques such as compression and normalization (eliminating redundant data).</p></li>
</ul>
<p>In contrast, plain files become unwieldy as data grows, leading to performance bottlenecks and significant manual effort to manage.</p>
</section>
<section id="concurrency-and-multi-user-access">
<h3>4. <strong>Concurrency and Multi-User Access</strong><a class="headerlink" href="#concurrency-and-multi-user-access" title="Link to this heading">#</a></h3>
<p>Databases allow multiple users to access and modify data simultaneously without conflicts.</p>
<ul class="simple">
<li><p><strong>Locking Mechanisms</strong>: Databases manage concurrent access using row- or table-level locks, ensuring that no two users overwrite the same data.</p></li>
<li><p><strong>Version Control</strong>: Some databases support versioning, allowing users to work on data without overwriting others’ changes.</p></li>
</ul>
<p>Plain files lack these features and often require manual handling, such as creating multiple copies of files to allow simultaneous use, which is inefficient and error-prone.</p>
</section>
<section id="data-security">
<h3>5. <strong>Data Security</strong><a class="headerlink" href="#data-security" title="Link to this heading">#</a></h3>
<p>Databases provide robust security measures to protect sensitive data.</p>
<ul class="simple">
<li><p><strong>Authentication and Access Control</strong>: Databases allow companies to define user roles and permissions, ensuring only authorized personnel can access or modify specific datasets.</p></li>
<li><p><strong>Encryption</strong>: Many databases encrypt data at rest and in transit to prevent unauthorized access.</p></li>
<li><p><strong>Audit Trails</strong>: Databases log all user activity, making it easier to track who accessed or modified data.</p></li>
</ul>
<p>Plain files are much harder to secure and track, especially when shared across teams or stored on distributed systems.</p>
</section>
<section id="data-redundancy-and-backup">
<h3>6. <strong>Data Redundancy and Backup</strong><a class="headerlink" href="#data-redundancy-and-backup" title="Link to this heading">#</a></h3>
<p>Databases offer built-in mechanisms to manage redundancy and automate backups, ensuring data availability and recovery.</p>
<ul class="simple">
<li><p><strong>Replication</strong>: Databases can maintain multiple synchronized copies of data in real-time, ensuring redundancy for high availability.</p></li>
<li><p><strong>Automated Backups</strong>: Many databases support scheduled backups, including incremental backups for efficiency.</p></li>
<li><p><strong>Disaster Recovery</strong>: Advanced databases provide tools for disaster recovery, allowing businesses to quickly recover from hardware failures or data corruption.</p></li>
</ul>
<p>Plain files often require manual duplication, which increases the risk of errors and slows recovery in case of data loss.</p>
</section>
<section id="data-relationships-and-complex-structures">
<h3>7. <strong>Data Relationships and Complex Structures</strong><a class="headerlink" href="#data-relationships-and-complex-structures" title="Link to this heading">#</a></h3>
<p>Relational databases store and manage relationships between datasets using primary and foreign keys.</p>
<ul class="simple">
<li><p><strong>Normalization</strong>: Breaks down data into smaller, logically connected tables to avoid duplication and ensure consistency.</p></li>
<li><p><strong>Joins</strong>: Databases can efficiently combine data across multiple tables to answer complex questions.</p></li>
</ul>
<p>In plain files, maintaining relationships between datasets requires significant manual effort, such as creating multiple files and writing custom code to merge them.</p>
</section>
<section id="scalable-data-analytics">
<h3>8. <strong>Scalable Data Analytics</strong><a class="headerlink" href="#scalable-data-analytics" title="Link to this heading">#</a></h3>
<p>Databases integrate with analytics and reporting tools, enabling companies to derive insights from their data.</p>
<ul class="simple">
<li><p><strong>Business Intelligence (BI) Tools</strong>: Databases can directly feed data into tools like Tableau, Power BI, or Python-based analytics pipelines.</p></li>
<li><p><strong>SQL for Analytics</strong>: Companies can use SQL to aggregate, filter, and transform data for advanced analytics without needing to write additional scripts.</p></li>
</ul>
<p>Plain files require additional preprocessing to prepare data for analysis, slowing down workflows.</p>
</section>
<section id="data-consistency-across-applications">
<h3>9. <strong>Data Consistency Across Applications</strong><a class="headerlink" href="#data-consistency-across-applications" title="Link to this heading">#</a></h3>
<p>Large companies often have multiple systems (e.g., finance, HR, marketing) that need to share data. Databases serve as a <strong>centralized repository</strong> for this data, ensuring consistency across applications.</p>
<ul class="simple">
<li><p><strong>Integration</strong>: Databases can be accessed through APIs and middleware, enabling seamless integration with software systems.</p></li>
<li><p><strong>Real-Time Updates</strong>: Changes made in a database are immediately reflected in all connected systems, which is not possible with plain files.</p></li>
</ul>
</section>
<section id="regulatory-compliance">
<h3>10. <strong>Regulatory Compliance</strong><a class="headerlink" href="#regulatory-compliance" title="Link to this heading">#</a></h3>
<p>Many industries, such as finance and healthcare, are subject to strict regulations regarding data storage, access, and reporting.</p>
<ul class="simple">
<li><p><strong>Auditability</strong>: Databases maintain detailed logs of data access and changes, enabling compliance with laws like GDPR and SOX.</p></li>
<li><p><strong>Retention Policies</strong>: Databases can enforce retention policies to archive or delete data as required by law.</p></li>
</ul>
<p>Plain files lack built-in logging and retention features, making them unsuitable for compliance purposes.</p>
</section>
<section id="summary-table-database-vs-plain-files">
<h3>Summary Table: Database vs. Plain Files<a class="headerlink" href="#summary-table-database-vs-plain-files" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Database</p></th>
<th class="head"><p>Plain Files</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Querying and Searching</p></td>
<td><p>Optimized (e.g., indexing)</p></td>
<td><p>Inefficient (line-by-line)</p></td>
</tr>
<tr class="row-odd"><td><p>Data Integrity</p></td>
<td><p>High (ACID compliance)</p></td>
<td><p>Manual error handling</p></td>
</tr>
<tr class="row-even"><td><p>Scalability</p></td>
<td><p>Handles terabytes/petabytes</p></td>
<td><p>Limited to small datasets</p></td>
</tr>
<tr class="row-odd"><td><p>Security</p></td>
<td><p>Authentication, encryption</p></td>
<td><p>Basic file permissions</p></td>
</tr>
<tr class="row-even"><td><p>Backup and Recovery</p></td>
<td><p>Automated backups, replication</p></td>
<td><p>Manual backups</p></td>
</tr>
<tr class="row-odd"><td><p>Multi-User Access</p></td>
<td><p>Supported with concurrency</p></td>
<td><p>Limited or unsupported</p></td>
</tr>
<tr class="row-even"><td><p>Data Relationships</p></td>
<td><p>Built-in support (joins)</p></td>
<td><p>Manual handling required</p></td>
</tr>
<tr class="row-odd"><td><p>Regulatory Compliance</p></td>
<td><p>Built-in logging and policies</p></td>
<td><p>Lacks built-in compliance</p></td>
</tr>
</tbody>
</table>
</div>
<p>In summary, databases are far superior to plain files for managing large, complex, and sensitive datasets. They offer efficiency, security, scalability, and the ability to handle concurrent users, making them indispensable for large companies, especially in data-intensive industries like finance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

<div class="section ablog__blog_comments">
   
</div>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Week3/project_structure.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Project Structure</p>
      </div>
    </a>
    <a class="right-next"
       href="../overview_w4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 4: Generating Reports, featuring Jupyter Notebooks and LaTeX</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-sql">What is SQL?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-sql-so-useful">Why is SQL so useful?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-are-relational-databases-so-popular">Why are relational databases so popular?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-sql-syntax">Basic SQL Syntax</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-data">1. <strong>Selecting Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">2. <strong>Filtering Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joining-tables">3. <strong>Joining Tables</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregating-data">4. <strong>Aggregating Data</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-queries-in-the-repository">Example Queries in the Repository</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-from-pull-crsp-stock-py">1. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_CRSP_stock.py</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-from-pull-crsp-compustat-py">2. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_CRSP_Compustat.py</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-from-pull-sp500-constituents-py">3. <strong>Query from <code class="docutils literal notranslate"><span class="pre">pull_SP500_constituents.py</span></code></strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-why-are-databases-so-important">Appendix: Why are databases so important?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#efficient-data-management-and-querying">1. <strong>Efficient Data Management and Querying</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-integrity">2. <strong>Data Integrity</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalability">3. <strong>Scalability</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concurrency-and-multi-user-access">4. <strong>Concurrency and Multi-User Access</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-security">5. <strong>Data Security</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-redundancy-and-backup">6. <strong>Data Redundancy and Backup</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-relationships-and-complex-structures">7. <strong>Data Relationships and Complex Structures</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalable-data-analytics">8. <strong>Scalable Data Analytics</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-consistency-across-applications">9. <strong>Data Consistency Across Applications</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regulatory-compliance">10. <strong>Regulatory Compliance</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-table-database-vs-plain-files">Summary Table: Database vs. Plain Files</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremiah Bejarano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Jeremiah Bejarano.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>