
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Replicating the GÃ¼rkaynak, Sack, and Wright (2006) Treasury Yield Curve &#8212; Full Stack Quantitative Finance</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'output/_02_replicate_GSW2005';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 7: Bloomberg and LSEG Datastream" href="../lectures/Week7/overview_w7.html" />
    <link rel="prev" title="CRSP Treasury Data Oveview" href="_01_CRSP_treasury_overview.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Full Stack Quantitative Finance - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Full Stack Quantitative Finance - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Full Stack Quantitative Finance
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Course Syllabus: FINM 32900, Winter 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lectures/Week1/HW0.html">Homework 0: Setting up your computing environment</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week1/overview_w1.html">Week 1: GitHub, GitHub Classroom, and Virtual Environments</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week1/what_is_this_course_about.html">What is Full Stack Quantitative Finance? Why This Course?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week1/reproducible_analytical_pipelines.html">What are Reproducible Analytical Pipelines?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week1/case_study_reproducibility_in_finance.html">Case Study: Is There A Reproducibility Crisis In Finance?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week1/virtual_environments.html">Virtual Environments</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week1/HW1.html">Homework 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week1/case_study_atlanta_fed_wage_growth_tracker.html">Case Study: Atlanta Fed Wage Growth Tracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="_01_wage_growth_during_the_recession.html">HW Guide: Wage Growth During the Recession</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week2/overview_w2.html">Week 2: Env Files and Secrets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week2/WRDS_intro_and_web_queries.html">Introduction to WRDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="_01_wrds_python_package.html">Example: Connecting to the WRDS Platform With Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week2/env_files.html">Env Files, Secrets, and the Separations of Settings from Code</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week2/HW2.html">Homework 2</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_02_CRSP_market_index.html">HW Guide Part A: CRSP Market Returns Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="_03_SP500_constituents_and_index.html">HW Guide Part B: Reconstructing the S&amp;P 500 Index</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week3/overview_w3.html">Week 3: Task Runners, Automating Queries, and the Basics of SQL</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week3/what_is_a_task_runner.html">What is a build system or task runner?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week2/project_structure.html">Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="_05_basics_of_SQL.html">Basics of SQL</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week3/HW3.html">Homework 3</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_04_Fama_French_1993.html">HW Guide Part A: Replicate Fama-French 1993</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week4/overview_w4.html">Week 4: Generating Reports, featuring Jupyter Notebooks and LaTeX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week4/reports_with_jupyter_notebooks.html">Reports with Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week4/intro_to_LaTeX.html">Introduction to LaTeX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week4/latex_essentials.html">LaTeX Essentials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week5/overview_w5.html">Week 5: Unit Tests and Documentation with Sphinx</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week5/sphinx.html">Sphinx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week5/unit_tests.html">Unit Tests</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week6/overview_w6.html">Week 6: Python Package Development and Social Coding with GitHub</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week6/GitHub_pull_requests.html">GitHub Issues and Pull Requests: Enhancing Collaborative Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week6/python_packaging_with_hatch.html">Writing and Publishing Your Own Python Packages</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../lectures/Week6/HW4.html">Homework 4</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="_01_CRSP_treasury_overview.html">CRSP Treasury Data Oveview</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Replicating the GÃ¼rkaynak, Sack, and Wright (2006) Treasury Yield Curve</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week7/overview_w7.html">Week 7: Bloomberg and LSEG Datastream</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week7/bloomberg_terminal.html">The Bloomberg Terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week7/LSEG_datastream.html">LSEG Datastream</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../lectures/subject_to_change_after_this_week.html">âSchedule subject to change after HEREâ</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Week8/overview_w8.html">Week 8: GitHub Actions and Publishing a Live Dashboard</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Week8/github_actions_interactive_dashboard.html">Creating a Live Dashboard Example with GitHub Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="_01_repo_spikes.html">Rate Spikes in the Market for Repurchase Agreements</a></li>



</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/Misc/final_project.html">Final Project</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Misc/final_project_rubric.html">Final Project Instructions and Rubric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/Misc/potential_final_projects.html">List of Potential Final Projects</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../lectures/Misc/appendix.html">Appendix</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/finm-32900/finm-32900-data-science" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/finm-32900/finm-32900-data-science/issues/new?title=Issue%20on%20page%20%2Foutput/_02_replicate_GSW2005.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/output/_02_replicate_GSW2005.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Replicating the GÃ¼rkaynak, Sack, and Wright (2006) Treasury Yield Curve</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-nelson-siegel-svensson-model">The Nelson-Siegel-Svensson Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theoretical-foundations">Theoretical Foundations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-curve-fitting-approach">1. <strong>Static Curve-Fitting Approach</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absence-of-no-arbitrage-restrictions">2. <strong>Absence of No-Arbitrage Restrictions</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-dynamics-and-risk-premiums">3. <strong>Factor Dynamics and Risk Premiums</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contrast-with-arbitrage-free-extensions">4. <strong>Contrast with Arbitrage-Free Extensions</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#empirical-vs-theoretical-focus">5. <strong>Empirical vs. Theoretical Focus</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-filtering">Data Filtering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-steps">Implementation Steps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">1. Data Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cashflow-construction">2. Cashflow Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting">3. Model Fitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-and-validation">Testing and Validation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="replicating-the-gurkaynak-sack-and-wright-2006-treasury-yield-curve">
<h1>Replicating the GÃ¼rkaynak, Sack, and Wright (2006) Treasury Yield Curve<a class="headerlink" href="#replicating-the-gurkaynak-sack-and-wright-2006-treasury-yield-curve" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In this section, weâll explore how to replicate the U.S. Treasury yield curve estimation methodology developed by GÃ¼rkaynak, Sack, and Wright (2006) (hereafter GSW). The GSW yield curve has become a standard benchmark in both academic research and industry practice. Their approach provides daily estimates of the U.S. Treasury yield curve from 1961 to the present, making it an invaluable resource for analyzing historical interest rate dynamics.</p>
</section>
<section id="the-nelson-siegel-svensson-model">
<h2>The Nelson-Siegel-Svensson Model<a class="headerlink" href="#the-nelson-siegel-svensson-model" title="Link to this heading">#</a></h2>
<p>The GSW methodology employs the Nelson-Siegel-Svensson (NSS) model to fit the yield curve. The NSS model expresses instantaneous forward rates using a flexible functional form with six parameters:</p>
<p>Example: NSS Forward Rate Function
The instantaneous forward rate n years ahead is given by:</p>
<div class="math notranslate nohighlight">
\[
f(n) = \beta_1 + \beta_2 e^{-n/\tau_1} + \beta_3\left(\frac{n}{\tau_1}\right)e^{-n/\tau_1} + \beta_4\left(\frac{n}{\tau_2}\right)e^{-n/\tau_2}
\]</div>
<p>This specification allows for rich curve shapes while maintaining smoothness and asymptotic behavior. The parameters have intuitive interpretations:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span>: The asymptotic forward rate</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span>, <span class="math notranslate nohighlight">\(\beta_3\)</span>, <span class="math notranslate nohighlight">\(\beta_4\)</span>: Control the shape and humps of the curve</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau_1\)</span>, <span class="math notranslate nohighlight">\(\tau_2\)</span>: Determine the location of curve features</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y(t) = \beta_1 + \beta_2\left(\frac{1-e^{-t/\tau_1}}{t/\tau_1}\right) + \beta_3\left(\frac{1-e^{-t/\tau_1}}{t/\tau_1} - e^{-t/\tau_1}\right) + \beta_4\left(\frac{1-e^{-t/\tau_2}}{t/\tau_2} - e^{-t/\tau_2}\right)
\]</div>
<p>This equation shows the zero-coupon yield <span class="math notranslate nohighlight">\(y(t)\)</span> for maturity <span class="math notranslate nohighlight">\(t\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pull_CRSP_treasury</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pull_yield_curve_data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gsw2006_yield_curve</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">config</span>

<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s2">&quot;DATA_DIR&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nelson-Siegel-Svensson parameters</span>
<span class="c1"># &quot;tau1&quot;, &quot;tau2&quot;, &quot;beta1&quot;, &quot;beta2&quot;, &quot;beta3&quot;, &quot;beta4&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>

<span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">plot_spot_curve</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0cc066cf347c5a9ad3b18205e7c85c3223547044b973711e7917ecce1b539fed.png" src="../_images/0cc066cf347c5a9ad3b18205e7c85c3223547044b973711e7917ecce1b539fed.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nelson-Siegel-Svensson parameters</span>
<span class="c1"># &quot;tau1&quot;, &quot;tau2&quot;, &quot;beta1&quot;, &quot;beta2&quot;, &quot;beta3&quot;, &quot;beta4&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">])</span>

<span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">plot_spot_curve</span><span class="p">(</span><span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ad9e649cfa74906b7a3ef1647cccfc71cf604b9f6998675671672fea2e3a2c53.png" src="../_images/ad9e649cfa74906b7a3ef1647cccfc71cf604b9f6998675671672fea2e3a2c53.png" />
</div>
</div>
</section>
<section id="theoretical-foundations">
<h2>Theoretical Foundations<a class="headerlink" href="#theoretical-foundations" title="Link to this heading">#</a></h2>
<p>The Nelson-Siegel-Svensson model is commonly used in practice to fit the yield curve. It has statistically appealing properties, but it is not arbitrage-free. Hereâs a detailed breakdown of why:</p>
<section id="static-curve-fitting-approach">
<h3>1. <strong>Static Curve-Fitting Approach</strong><a class="headerlink" href="#static-curve-fitting-approach" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The NSS model is primarily a <strong>parametric curve-fitting tool</strong> that focuses on matching observed yields at a single point in time.</p></li>
<li><p>It does not model the <strong>dynamic evolution of interest rates</strong> or enforce consistency between short-term rate expectations and long-term yields over time, a key requirement for no-arbitrage models.</p></li>
</ul>
</section>
<section id="absence-of-no-arbitrage-restrictions">
<h3>2. <strong>Absence of No-Arbitrage Restrictions</strong><a class="headerlink" href="#absence-of-no-arbitrage-restrictions" title="Link to this heading">#</a></h3>
<ul>
<li><p>No-arbitrage models impose constraints to prevent risk-free profits. For example, affine term structure models derive bond prices from:</p>
<div class="math notranslate nohighlight">
\[
     P(t,T) = \mathbb{E}^\mathbb{Q}\left[e^{-\int_t^T r_s ds}\right],
     \]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span> is the risk-neutral measure. The NSS model lacks such theoretical foundations.</p>
</li>
<li><p>The NSS parameters (e.g., level, slope, curvature) are <strong>statistically estimated</strong> rather than derived from economic principles or arbitrage-free dynamics.</p></li>
</ul>
</section>
<section id="factor-dynamics-and-risk-premiums">
<h3>3. <strong>Factor Dynamics and Risk Premiums</strong><a class="headerlink" href="#factor-dynamics-and-risk-premiums" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>In arbitrage-free models, factor dynamics (e.g., mean reversion) and risk premiums are explicitly defined to ensure consistency across maturities. The NSS model treats factors as <strong>latent variables</strong> without specifying their stochastic behavior or market price of risk.</p></li>
<li><p>This omission allows potential inconsistencies between short-rate expectations and long-term yields, creating theoretical arbitrage opportunities.</p></li>
</ul>
</section>
<section id="contrast-with-arbitrage-free-extensions">
<h3>4. <strong>Contrast with Arbitrage-Free Extensions</strong><a class="headerlink" href="#contrast-with-arbitrage-free-extensions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The <strong>arbitrage-free Nelson-Siegel (AFNS)</strong> model, developed by Christensen et al. (2007), addresses these limitations by:</p>
<ul>
<li><p>Embedding Nelson-Siegel factors into a dynamic arbitrage-free framework.</p></li>
<li><p>Explicitly defining factor dynamics under both physical (<span class="math notranslate nohighlight">\(\mathbb{P}\)</span>) and risk-neutral (<span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>) measures.</p></li>
<li><p>Ensuring internal consistency between yields of different maturities.</p></li>
</ul>
</li>
</ul>
</section>
<section id="empirical-vs-theoretical-focus">
<h3>5. <strong>Empirical vs. Theoretical Focus</strong><a class="headerlink" href="#empirical-vs-theoretical-focus" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The NSS model prioritizes <strong>empirical flexibility</strong> (e.g., fitting yield curve shapes like humps) over theoretical rigor. While it performs well in practice, this trade-off inherently sacrifices no-arbitrage guarantees.</p></li>
</ul>
<p>In summary, the NSS modelâs lack of dynamic factor specifications, absence of explicit no-arbitrage constraints, and focus on cross-sectional fitting rather than intertemporal consistency render it theoretically incompatible with arbitrage-free principles. Its successors, such as the AFNS model, bridge this gap by integrating no-arbitrage restrictions while retaining empirical tractability.</p>
</section>
</section>
<section id="data-filtering">
<h2>Data Filtering<a class="headerlink" href="#data-filtering" title="Link to this heading">#</a></h2>
<p>One important step of the GSW methodology is careful filtering of Treasury securities.</p>
<p>The following filters are implemented:</p>
<ol class="arabic simple">
<li><p>Exclude securities with &lt; 3 months to maturity</p></li>
<li><p>Exclude on-the-run and first off-the-run issues after 1980</p></li>
<li><p>Exclude T-bills (only keep notes and bonds)</p></li>
<li><p>Exclude 20-year bonds after 1996 with decay</p></li>
<li><p>Exclude callable bonds</p></li>
</ol>
<p>The GSW paper also includes ad hoc exclusions for specific issues, which are not implemented here.</p>
<p>Why are these filters important?</p>
<p>For (2), this is what the paper says:</p>
<blockquote>
<div><p>We exclude the two most recently issued securities with maturities of two,
three, four, five, seven, ten, twenty, and thirty years for securities
issued in 1980 or later. These are the âon-the-runâ and âfirst off-the-runâ
issues that often trade at a premium to other Treasury securities, owing to
their greater liquidity and their frequent specialness in the repo market.8
Earlier in the sample, the concept of an on-the-run issue was not well
defined, since the Treasury did not conduct regular auctions and the repo
market was not well developed (as discussed by Garbade (2004)). Our cut-off
point for excluding onthe- run and first off-the-run issues is somewhat
arbitrary but is a conservative choice (in the sense of potentially erring
on the side of being too early).</p>
</div></blockquote>
<p>For (4), this is what the paper says:</p>
<blockquote>
<div><p>We begin to exclude twenty-year bonds in 1996, because those securities
often appeared cheap relative to ten-year notes with comparable duration.
This cheapness could reflect their lower liquidity or the fact that their
high coupon rates made them unattractive to hold for tax-related reasons.</p>
<p>To avoid an abrupt change to the sample, we allow their weights to linearly
decay from 1 to 0 over the year ending on January 2, 1996.</p>
</div></blockquote>
<p>Letâs examine how we implement these filters using CRSP data. The following is
from the <code class="docutils literal notranslate"><span class="pre">pull_CRSP_treasury.py</span></code> file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gurkaynak_sack_wright_filters</span><span class="p">(</span><span class="n">dff</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply Treasury security filters based on GÃ¼rkaynak, Sack, and Wright (2006).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">dff</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Filter 1: Exclude &lt; 3 months to maturity</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;days_to_maturity&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">92</span><span class="p">]</span>

    <span class="c1"># Filter 2: Exclude on-the-run and first off-the-run after 1980</span>
    <span class="n">post_1980</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;1980-01-01&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">post_1980</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">))]</span>

    <span class="c1"># Filter 3: Only include notes (2) and bonds (1)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;itype&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])]</span>

    <span class="c1"># Filter 4: Exclude 20-year bonds after 1996 with decay</span>
    <span class="n">cutoff_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;1996-01-02&quot;</span><span class="p">)</span>
    <span class="n">decay_start</span> <span class="o">=</span> <span class="n">cutoff_date</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="c1"># Apply linear decay only during 1995-01-02 to 1996-01-02</span>
    <span class="n">mask_decay</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;original_maturity&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">20</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">decay_start</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cutoff_date</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Calculate proper decay factor for the transition year</span>
    <span class="n">decay_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">cutoff_date</span> <span class="o">-</span> <span class="n">decay_start</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
    <span class="n">decay_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">decay_start</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span> <span class="o">/</span> <span class="n">decay_days</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask_decay</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">decay_factor</span>

    <span class="c1"># Completely exclude 20-year bonds after cutoff date</span>
    <span class="n">mask_exclude</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;original_maturity&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">cutoff_date</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask_exclude</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Filter 5: Exclude callable bonds</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;callable&quot;</span><span class="p">]]</span>

    <span class="c1"># Remove securities with zero/negative weights</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>

</pre></div>
</div>
<p>Letâs examine how this affects the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## Load Gurkaynak Sack Wright data from Federal Reserve&#39;s website</span>
<span class="c1"># See here: https://www.federalreserve.gov/data/nominal-yield-curve.htm</span>
<span class="c1"># and here: https://www.federalreserve.gov/data/yield-curve-tables/feds200628_1.html</span>
<span class="n">actual_all</span> <span class="o">=</span> <span class="n">pull_yield_curve_data</span><span class="o">.</span><span class="n">load_fed_yield_curve_all</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">)</span>
<span class="c1"># Create copy of parameter DataFrame to avoid view vs copy issues</span>
<span class="n">actual_params_all</span> <span class="o">=</span> <span class="n">actual_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">:,</span> <span class="p">[</span><span class="s2">&quot;TAU1&quot;</span><span class="p">,</span> <span class="s2">&quot;TAU2&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA0&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA1&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA2&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA3&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Convert percentage points to decimals for beta parameters</span>
<span class="n">beta_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BETA0&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA1&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA2&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA3&quot;</span><span class="p">]</span>
<span class="n">actual_params_all</span><span class="p">[</span><span class="n">beta_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">actual_params_all</span><span class="p">[</span><span class="n">beta_columns</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>


<span class="c1">## Load CRSP Treasury data from Wharton Research Data Services</span>
<span class="c1"># We will fit a Nelson-Siegel-Svensson model to this data to see</span>
<span class="c1"># if we can replicate the Gurkaynak Sack Wright results above.</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">pull_CRSP_treasury</span><span class="o">.</span><span class="n">load_CRSP_treasury_consolidated</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kytreasno</th>
      <th>kycrspid</th>
      <th>tcusip</th>
      <th>caldt</th>
      <th>tdatdt</th>
      <th>tmatdt</th>
      <th>tfcaldt</th>
      <th>tdbid</th>
      <th>tdask</th>
      <th>tdaccint</th>
      <th>...</th>
      <th>price</th>
      <th>tcouprt</th>
      <th>itype</th>
      <th>original_maturity</th>
      <th>years_to_maturity</th>
      <th>tdduratn</th>
      <th>tdretnua</th>
      <th>days_to_maturity</th>
      <th>callable</th>
      <th>run</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2444132</th>
      <td>206527.0</td>
      <td>20220815.201620</td>
      <td>912828TJ</td>
      <td>2020-02-12</td>
      <td>2012-08-15</td>
      <td>2022-08-15</td>
      <td>0</td>
      <td>100.484375</td>
      <td>100.507812</td>
      <td>0.799253</td>
      <td>...</td>
      <td>101.295346</td>
      <td>1.625</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>3.0</td>
      <td>893.278231</td>
      <td>-0.000766</td>
      <td>915</td>
      <td>False</td>
      <td>29</td>
    </tr>
    <tr>
      <th>2444133</th>
      <td>206527.0</td>
      <td>20220815.201620</td>
      <td>912828TJ</td>
      <td>2020-02-13</td>
      <td>2012-08-15</td>
      <td>2022-08-15</td>
      <td>0</td>
      <td>100.500000</td>
      <td>100.523438</td>
      <td>0.803668</td>
      <td>...</td>
      <td>101.315387</td>
      <td>1.625</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>3.0</td>
      <td>892.280743</td>
      <td>0.000198</td>
      <td>914</td>
      <td>False</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2444134</th>
      <td>206527.0</td>
      <td>20220815.201620</td>
      <td>912828TJ</td>
      <td>2020-02-14</td>
      <td>2012-08-15</td>
      <td>2022-08-15</td>
      <td>0</td>
      <td>100.539062</td>
      <td>100.578125</td>
      <td>0.808084</td>
      <td>...</td>
      <td>101.366678</td>
      <td>1.625</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>3.0</td>
      <td>891.288136</td>
      <td>0.000506</td>
      <td>913</td>
      <td>False</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2444135</th>
      <td>206527.0</td>
      <td>20220815.201620</td>
      <td>912828TJ</td>
      <td>2020-02-18</td>
      <td>2012-08-15</td>
      <td>2022-08-15</td>
      <td>0</td>
      <td>100.593750</td>
      <td>100.601562</td>
      <td>0.013393</td>
      <td>...</td>
      <td>100.611049</td>
      <td>1.625</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>894.485158</td>
      <td>0.000561</td>
      <td>909</td>
      <td>False</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2444136</th>
      <td>206527.0</td>
      <td>20220815.201620</td>
      <td>912828TJ</td>
      <td>2020-02-19</td>
      <td>2012-08-15</td>
      <td>2022-08-15</td>
      <td>0</td>
      <td>100.562500</td>
      <td>100.570312</td>
      <td>0.017857</td>
      <td>...</td>
      <td>100.584263</td>
      <td>1.625</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>893.482521</td>
      <td>-0.000266</td>
      <td>908</td>
      <td>False</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã 21 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kytreasno</th>
      <th>caldt</th>
      <th>tdatdt</th>
      <th>tmatdt</th>
      <th>tfcaldt</th>
      <th>tdbid</th>
      <th>tdask</th>
      <th>tdaccint</th>
      <th>tdyld</th>
      <th>price</th>
      <th>tcouprt</th>
      <th>itype</th>
      <th>original_maturity</th>
      <th>years_to_maturity</th>
      <th>tdduratn</th>
      <th>tdretnua</th>
      <th>days_to_maturity</th>
      <th>run</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.444137e+06</td>
      <td>2444137</td>
      <td>2444137</td>
      <td>2444137</td>
      <td>2444137.0</td>
      <td>2.444093e+06</td>
      <td>2.444093e+06</td>
      <td>2.444137e+06</td>
      <td>2.444093e+06</td>
      <td>2.444093e+06</td>
      <td>2.444137e+06</td>
      <td>2.444137e+06</td>
      <td>2.444137e+06</td>
      <td>2.444137e+06</td>
      <td>2.444137e+06</td>
      <td>2.442115e+06</td>
      <td>2.444137e+06</td>
      <td>2.444137e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.044759e+05</td>
      <td>2004-05-19 21:05:09.422097920</td>
      <td>1999-07-19 03:10:44.848467968</td>
      <td>2010-07-22 08:13:12.568337408</td>
      <td>0.0</td>
      <td>1.047043e+02</td>
      <td>1.047902e+02</td>
      <td>1.355873e+00</td>
      <td>1.207134e-04</td>
      <td>1.061031e+02</td>
      <td>5.448518e+00</td>
      <td>1.748902e+00</td>
      <td>1.099878e+01</td>
      <td>6.177746e+00</td>
      <td>1.643023e+03</td>
      <td>1.994802e-04</td>
      <td>2.254464e+03</td>
      <td>1.881510e+01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.006360e+05</td>
      <td>1970-01-02 00:00:00</td>
      <td>1955-02-15 00:00:00</td>
      <td>1970-02-15 00:00:00</td>
      <td>0.0</td>
      <td>4.350000e+01</td>
      <td>4.354688e+01</td>
      <td>0.000000e+00</td>
      <td>-1.664162e-02</td>
      <td>4.405673e+01</td>
      <td>1.250000e-01</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>-1.000000e+00</td>
      <td>-1.094112e-01</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.028010e+05</td>
      <td>1992-04-03 00:00:00</td>
      <td>1986-12-03 00:00:00</td>
      <td>1996-09-30 00:00:00</td>
      <td>0.0</td>
      <td>9.910938e+01</td>
      <td>9.917969e+01</td>
      <td>3.532609e-01</td>
      <td>4.683062e-05</td>
      <td>9.990217e+01</td>
      <td>2.375000e+00</td>
      <td>1.000000e+00</td>
      <td>5.000000e+00</td>
      <td>1.000000e+00</td>
      <td>5.100068e+02</td>
      <td>-5.757035e-04</td>
      <td>5.260000e+02</td>
      <td>5.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.040500e+05</td>
      <td>2007-05-04 00:00:00</td>
      <td>1998-11-15 00:00:00</td>
      <td>2014-03-31 00:00:00</td>
      <td>0.0</td>
      <td>1.010547e+02</td>
      <td>1.011172e+02</td>
      <td>9.191576e-01</td>
      <td>1.159452e-04</td>
      <td>1.024460e+02</td>
      <td>5.000000e+00</td>
      <td>2.000000e+00</td>
      <td>7.000000e+00</td>
      <td>3.000000e+00</td>
      <td>1.108149e+03</td>
      <td>1.431182e-04</td>
      <td>1.208000e+03</td>
      <td>1.400000e+01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.065920e+05</td>
      <td>2017-05-30 00:00:00</td>
      <td>2013-02-28 00:00:00</td>
      <td>2022-08-15 00:00:00</td>
      <td>0.0</td>
      <td>1.067812e+02</td>
      <td>1.068594e+02</td>
      <td>2.013467e+00</td>
      <td>1.736904e-04</td>
      <td>1.085687e+02</td>
      <td>7.875000e+00</td>
      <td>2.000000e+00</td>
      <td>1.000000e+01</td>
      <td>7.000000e+00</td>
      <td>2.150573e+03</td>
      <td>1.021177e-03</td>
      <td>2.536000e+03</td>
      <td>2.800000e+01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.083350e+05</td>
      <td>2024-12-31 00:00:00</td>
      <td>2024-12-31 00:00:00</td>
      <td>2054-11-15 00:00:00</td>
      <td>0.0</td>
      <td>1.763281e+02</td>
      <td>1.763906e+02</td>
      <td>1.186908e+01</td>
      <td>6.557793e-03</td>
      <td>1.827193e+02</td>
      <td>1.625000e+01</td>
      <td>2.000000e+00</td>
      <td>4.000000e+01</td>
      <td>3.000000e+01</td>
      <td>9.160067e+03</td>
      <td>1.281108e-01</td>
      <td>1.105300e+04</td>
      <td>8.400000e+01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.027969e+03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1.304764e+01</td>
      <td>1.302720e+01</td>
      <td>1.309228e+00</td>
      <td>8.890701e-05</td>
      <td>1.342238e+01</td>
      <td>3.586926e+00</td>
      <td>4.336449e-01</td>
      <td>9.959075e+00</td>
      <td>7.380510e+00</td>
      <td>1.624650e+03</td>
      <td>3.684351e-03</td>
      <td>2.689590e+03</td>
      <td>1.767407e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">gurkaynak_sack_wright_filters</span><span class="p">(</span><span class="n">df_all</span><span class="p">)</span>
<span class="n">df_all</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kytreasno</th>
      <th>caldt</th>
      <th>tdatdt</th>
      <th>tmatdt</th>
      <th>tfcaldt</th>
      <th>tdbid</th>
      <th>tdask</th>
      <th>tdaccint</th>
      <th>tdyld</th>
      <th>price</th>
      <th>tcouprt</th>
      <th>itype</th>
      <th>original_maturity</th>
      <th>years_to_maturity</th>
      <th>tdduratn</th>
      <th>tdretnua</th>
      <th>days_to_maturity</th>
      <th>run</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.047468e+06</td>
      <td>2047468</td>
      <td>2047468</td>
      <td>2047468</td>
      <td>2047468.0</td>
      <td>2.047462e+06</td>
      <td>2.047462e+06</td>
      <td>2.047468e+06</td>
      <td>2.047462e+06</td>
      <td>2.047462e+06</td>
      <td>2.047468e+06</td>
      <td>2.047468e+06</td>
      <td>2.047468e+06</td>
      <td>2.047468e+06</td>
      <td>2.047468e+06</td>
      <td>2.047282e+06</td>
      <td>2.047468e+06</td>
      <td>2.047468e+06</td>
      <td>2.047468e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.045261e+05</td>
      <td>2004-11-24 19:14:20.588395648</td>
      <td>1999-12-29 16:16:07.118411648</td>
      <td>2010-12-26 22:20:38.496718848</td>
      <td>0.0</td>
      <td>1.051147e+02</td>
      <td>1.051976e+02</td>
      <td>1.315912e+00</td>
      <td>1.172641e-04</td>
      <td>1.064721e+02</td>
      <td>5.314009e+00</td>
      <td>1.760971e+00</td>
      <td>1.098118e+01</td>
      <td>6.091611e+00</td>
      <td>1.639427e+03</td>
      <td>1.952504e-04</td>
      <td>2.223129e+03</td>
      <td>2.065100e+01</td>
      <td>9.992132e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.006560e+05</td>
      <td>1970-01-02 00:00:00</td>
      <td>1955-02-15 00:00:00</td>
      <td>1970-05-15 00:00:00</td>
      <td>0.0</td>
      <td>4.350000e+01</td>
      <td>4.354688e+01</td>
      <td>0.000000e+00</td>
      <td>-4.305986e-05</td>
      <td>4.405673e+01</td>
      <td>1.250000e-01</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>-1.000000e+00</td>
      <td>-1.094112e-01</td>
      <td>9.300000e+01</td>
      <td>0.000000e+00</td>
      <td>1.095890e-02</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.028440e+05</td>
      <td>1992-10-06 00:00:00</td>
      <td>1987-08-15 00:00:00</td>
      <td>1997-03-31 00:00:00</td>
      <td>0.0</td>
      <td>9.904688e+01</td>
      <td>9.910938e+01</td>
      <td>3.519022e-01</td>
      <td>4.453181e-05</td>
      <td>9.989436e+01</td>
      <td>2.250000e+00</td>
      <td>2.000000e+00</td>
      <td>5.000000e+00</td>
      <td>1.000000e+00</td>
      <td>5.210182e+02</td>
      <td>-5.814131e-04</td>
      <td>5.400000e+02</td>
      <td>8.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.040600e+05</td>
      <td>2008-11-03 00:00:00</td>
      <td>2000-03-31 00:00:00</td>
      <td>2015-07-15 00:00:00</td>
      <td>0.0</td>
      <td>1.014648e+02</td>
      <td>1.015273e+02</td>
      <td>8.981354e-01</td>
      <td>1.121552e-04</td>
      <td>1.027308e+02</td>
      <td>4.750000e+00</td>
      <td>2.000000e+00</td>
      <td>7.000000e+00</td>
      <td>3.000000e+00</td>
      <td>1.111342e+03</td>
      <td>1.428802e-04</td>
      <td>1.203000e+03</td>
      <td>1.600000e+01</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.066220e+05</td>
      <td>2017-10-05 00:00:00</td>
      <td>2013-05-15 00:00:00</td>
      <td>2022-10-31 00:00:00</td>
      <td>0.0</td>
      <td>1.073906e+02</td>
      <td>1.074609e+02</td>
      <td>1.944293e+00</td>
      <td>1.710489e-04</td>
      <td>1.091391e+02</td>
      <td>7.875000e+00</td>
      <td>2.000000e+00</td>
      <td>1.000000e+01</td>
      <td>7.000000e+00</td>
      <td>2.096096e+03</td>
      <td>1.010312e-03</td>
      <td>2.440000e+03</td>
      <td>2.900000e+01</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.082900e+05</td>
      <td>2024-12-31 00:00:00</td>
      <td>2024-09-30 00:00:00</td>
      <td>2054-02-15 00:00:00</td>
      <td>0.0</td>
      <td>1.763281e+02</td>
      <td>1.763906e+02</td>
      <td>1.186908e+01</td>
      <td>9.394247e-04</td>
      <td>1.827193e+02</td>
      <td>1.625000e+01</td>
      <td>2.000000e+00</td>
      <td>4.000000e+01</td>
      <td>2.900000e+01</td>
      <td>8.738464e+03</td>
      <td>1.281108e-01</td>
      <td>1.069200e+04</td>
      <td>8.100000e+01</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.030425e+03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1.334655e+01</td>
      <td>1.332798e+01</td>
      <td>1.261735e+00</td>
      <td>8.556826e-05</td>
      <td>1.371406e+01</td>
      <td>3.499509e+00</td>
      <td>4.264908e-01</td>
      <td>9.904625e+00</td>
      <td>7.189806e+00</td>
      <td>1.598785e+03</td>
      <td>3.589804e-03</td>
      <td>2.621508e+03</td>
      <td>1.719935e+01</td>
      <td>2.278002e-02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="implementation-steps">
<h2>Implementation Steps<a class="headerlink" href="#implementation-steps" title="Link to this heading">#</a></h2>
<section id="data-preparation">
<h3>1. Data Preparation<a class="headerlink" href="#data-preparation" title="Link to this heading">#</a></h3>
<p>First, we load and clean the CRSP Treasury data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span> <span class="o">=</span> <span class="n">pull_CRSP_treasury</span><span class="o">.</span><span class="n">load_CRSP_treasury_consolidated</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cashflow-construction">
<h3>2. Cashflow Construction<a class="headerlink" href="#cashflow-construction" title="Link to this heading">#</a></h3>
<p>For each Treasury security, we need to calculate its future cashflows. Consider the following simplified example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;tcusip&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">],</span>
        <span class="s2">&quot;tmatdt&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;2000-05-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-05-31&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-06-30&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-07-31&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-08-15&quot;</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">103</span><span class="p">],</span>
        <span class="s2">&quot;tcouprt&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
        <span class="s2">&quot;caldt&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2000-01-31&quot;</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">cashflow</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">calc_cashflows</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>

<span class="c1"># Treasury securities have 2 coupon payments per year</span>
<span class="c1"># and pay their final coupon and principal on the maturity date</span>
<span class="n">expected_cashflow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">103.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">103.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">102.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">103.0</span><span class="p">],</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cashflow</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2000-02-15</th>
      <th>2000-05-15</th>
      <th>2000-05-31</th>
      <th>2000-06-30</th>
      <th>2000-07-31</th>
      <th>2000-08-15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>103.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>103.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>102.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>103.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="model-fitting">
<h3>3. Model Fitting<a class="headerlink" href="#model-fitting" title="Link to this heading">#</a></h3>
<p>The NSS model is fit by minimizing price errors weighted by duration:</p>
<div class="math notranslate nohighlight">
\[
\min_{\beta,\tau} \sum_{i=1}^N \frac{(P_i^{obs} - P_i^{model})^2}{D_i}
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P_i^{obs}\)</span> = Observed clean price (including accrued interest)</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i^{model}\)</span> = Model-implied price</p></li>
<li><p><span class="math notranslate nohighlight">\(D_i\)</span> = Duration of security i</p></li>
</ul>
<p>Now, why are the squared errors weighted by the duration?</p>
<p>Recall that bond duration is a measurement of how much a bondâs price will change in response to interest rate changes.
Thus, the price error objective is approximately equivalent to minimizing unweighted yield errors:</p>
<div class="math notranslate nohighlight">
\[
\frac{(P_i^{obs} - P_i^{model})^2}{D_i} \approx D_i \cdot (y_i^{obs} - y_i^{model})^2
\]</div>
<p>This approximation comes from the duration relationship:
$<span class="math notranslate nohighlight">\(
P^{obs} - P^{model} \approx -D \cdot (y^{obs} - y^{model})
\)</span>$</p>
<p>Making the objective function:
$<span class="math notranslate nohighlight">\(
\sum D_i \cdot (y_i^{obs} - y_i^{model})^2
\)</span>$</p>
<p>So, why Price Errors Instead of Yield Errors?</p>
<ol class="arabic simple">
<li><p><strong>Non-linear relationship</strong>: The price/yield relationship is convex
(convexity adjustment matters more for long-duration bonds)</p></li>
<li><p><strong>Coupon effects</strong>: Directly accounts for differential cash flow timing</p></li>
<li><p><strong>Numerical stability</strong>: Prices have linear sensitivity to parameters via
discount factors, while yields require non-linear root-finding</p></li>
<li><p><strong>Economic meaning</strong>: Aligns with trader behavior that thinks in terms of
price arbitrage</p></li>
</ol>
<p>Reference: Gurkaynak, Sack, and Wright (2006)</p>
</section>
<section id="note">
<h3>Note<a class="headerlink" href="#note" title="Link to this heading">#</a></h3>
<p>Note that the paper says the following:</p>
<blockquote>
<div><p>In estimating the yield curve, we choose the parameters to minimize the weighted
sum of the squared deviations between the actual prices of Treasury securities and the
predicted prices. The weights chosen are the inverse of the duration of each individual
security. To a rough approximation, the deviation between the actual and predicted
prices of an individual security will equal its duration multiplied by the deviation
between the actual and predicted yields. Thus, this procedure is approximately equal to
minimizing the (unweighted) sum of the squared deviations between the actual and
predicted yields on all of the securities.</p>
</div></blockquote>
<p>However, I need to check this further since it initially seems to me that this procedure is minimizing the squared yield errors, weighted by the duration. However, the fit to actual prices seems better with the procedure above. I need to check this further.</p>
</section>
</section>
<section id="testing-and-validation">
<h2>Testing and Validation<a class="headerlink" href="#testing-and-validation" title="Link to this heading">#</a></h2>
<p>To validate our implementation, we compare our fitted yields against the official GSW yields published by the Federal Reserve:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1">## Load Gurkaynak Sack Wright data from Federal Reserve&#39;s website</span>
<span class="c1"># See here: https://www.federalreserve.gov/data/nominal-yield-curve.htm</span>
<span class="c1"># and here: https://www.federalreserve.gov/data/yield-curve-tables/feds200628_1.html</span>
<span class="n">actual_all</span> <span class="o">=</span> <span class="n">pull_yield_curve_data</span><span class="o">.</span><span class="n">load_fed_yield_curve_all</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">)</span>
<span class="c1"># Create copy of parameter DataFrame to avoid view vs copy issues</span>
<span class="n">actual_params_all</span> <span class="o">=</span> <span class="n">actual_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">:,</span> <span class="p">[</span><span class="s2">&quot;TAU1&quot;</span><span class="p">,</span> <span class="s2">&quot;TAU2&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA0&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA1&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA2&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA3&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Convert percentage points to decimals for beta parameters</span>
<span class="n">beta_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BETA0&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA1&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA2&quot;</span><span class="p">,</span> <span class="s2">&quot;BETA3&quot;</span><span class="p">]</span>
<span class="n">actual_params_all</span><span class="p">[</span><span class="n">beta_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">actual_params_all</span><span class="p">[</span><span class="n">beta_columns</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>


<span class="c1">## Load CRSP Treasury data from Wharton Research Data Services</span>
<span class="c1"># We will fit a Nelson-Siegel-Svensson model to this data to see</span>
<span class="c1"># if we can replicate the Gurkaynak Sack Wright results above.</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">pull_CRSP_treasury</span><span class="o">.</span><span class="n">load_CRSP_treasury_consolidated</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">)</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">gurkaynak_sack_wright_filters</span><span class="p">(</span><span class="n">df_all</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">quote_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2000-01-02&quot;</span><span class="p">,</span> <span class="s2">&quot;2024-06-30&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;BMS&quot;</span><span class="p">)</span>
<span class="c1"># quote_date = quote_dates[-1]</span>

<span class="c1">## Test Day 1</span>
<span class="n">quote_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2024-06-03&quot;</span><span class="p">)</span>
<span class="c1"># Subset df_all to quote_date</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[</span><span class="n">df_all</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">quote_date</span><span class="p">]</span>
<span class="n">actual_params</span> <span class="o">=</span> <span class="n">actual_params_all</span><span class="p">[</span><span class="n">actual_params_all</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">quote_date</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># &quot;tau1&quot;, &quot;tau2&quot;, &quot;beta1&quot;, &quot;beta2&quot;, &quot;beta3&quot;, &quot;beta4&quot;</span>
<span class="c1"># params0 = np.array([1.0, 10.0, 3.0, 3.0, 3.0, 3.0])</span>
<span class="n">params0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.989721</span><span class="p">,</span> <span class="mf">9.955324</span><span class="p">,</span> <span class="mf">3.685087</span><span class="p">,</span> <span class="mf">1.579927</span><span class="p">,</span> <span class="mf">3.637107</span><span class="p">,</span> <span class="mf">9.814584</span><span class="p">])</span>
<span class="c1"># params0 = np.array([1.0, 1.0, 0.001, 0.001, 0.001, 0.001])</span>

<span class="n">params_star</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">quote_date</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">params0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## Visualize the fit</span>
<span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">plot_spot_curve</span><span class="p">(</span><span class="n">params_star</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/69322d3079b9e09a7daa4c0d68733de047af40a157b13bc02b7fa27025f457ed.png" src="../_images/69322d3079b9e09a7daa4c0d68733de047af40a157b13bc02b7fa27025f457ed.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Spot Curve&#39;}, xlabel=&#39;Maturity&#39;, ylabel=&#39;Spot Rate&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">plot_spot_curve</span><span class="p">(</span><span class="n">actual_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/00ab3f3dd50e4f66eac9f1f994c9362ebff214e13e4d08c7230a7a23d74aa09f.png" src="../_images/00ab3f3dd50e4f66eac9f1f994c9362ebff214e13e4d08c7230a7a23d74aa09f.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Spot Curve&#39;}, xlabel=&#39;Maturity&#39;, ylabel=&#39;Spot Rate&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">price_comparison</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">compare_fit</span><span class="p">(</span>
    <span class="n">quote_date</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">params_star</span><span class="p">,</span> <span class="n">actual_params</span><span class="p">,</span> <span class="n">df</span>
<span class="p">)</span>
<span class="n">price_comparison</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Actual Price</th>
      <th>GSW Predicted Price</th>
      <th>Model Predicted Price</th>
      <th>Predicted - Actual %</th>
      <th>Predicted - GSW %</th>
    </tr>
    <tr>
      <th>tcusip</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>912810ET</th>
      <td>104.189560</td>
      <td>103.877734</td>
      <td>103.934442</td>
      <td>-0.002449</td>
      <td>0.000546</td>
    </tr>
    <tr>
      <th>912810EV</th>
      <td>104.504035</td>
      <td>104.146501</td>
      <td>104.170066</td>
      <td>-0.003196</td>
      <td>0.000226</td>
    </tr>
    <tr>
      <th>912810EW</th>
      <td>103.835766</td>
      <td>103.539602</td>
      <td>103.500390</td>
      <td>-0.003230</td>
      <td>-0.000379</td>
    </tr>
    <tr>
      <th>912810EX</th>
      <td>106.232229</td>
      <td>106.071133</td>
      <td>105.960492</td>
      <td>-0.002558</td>
      <td>-0.001043</td>
    </tr>
    <tr>
      <th>912810EY</th>
      <td>105.202785</td>
      <td>104.356538</td>
      <td>104.209629</td>
      <td>-0.009440</td>
      <td>-0.001408</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91282CKC</th>
      <td>100.226053</td>
      <td>100.302116</td>
      <td>100.082135</td>
      <td>-0.001436</td>
      <td>-0.002193</td>
    </tr>
    <tr>
      <th>91282CFX</th>
      <td>99.622823</td>
      <td>99.636803</td>
      <td>99.691386</td>
      <td>0.000688</td>
      <td>0.000548</td>
    </tr>
    <tr>
      <th>91282CHD</th>
      <td>99.124680</td>
      <td>99.201167</td>
      <td>99.241687</td>
      <td>0.001180</td>
      <td>0.000408</td>
    </tr>
    <tr>
      <th>91282CHV</th>
      <td>101.138417</td>
      <td>101.229223</td>
      <td>101.247245</td>
      <td>0.001076</td>
      <td>0.000178</td>
    </tr>
    <tr>
      <th>91282CHU</th>
      <td>100.349159</td>
      <td>100.468617</td>
      <td>100.358505</td>
      <td>0.000093</td>
      <td>-0.001096</td>
    </tr>
  </tbody>
</table>
<p>292 rows Ã 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## Assert that column is close to 0 for all CUSIPs</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">price_comparison</span><span class="p">[</span><span class="s2">&quot;Predicted - Actual %&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">price_comparison</span><span class="p">[</span><span class="s2">&quot;Predicted - GSW %&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1">## Test Day 2</span>
<span class="n">quote_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2000-06-05&quot;</span><span class="p">)</span>
<span class="c1"># Subset df_all to quote_date</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[</span><span class="n">df_all</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">quote_date</span><span class="p">]</span>
<span class="n">actual_params</span> <span class="o">=</span> <span class="n">actual_params_all</span><span class="p">[</span><span class="n">actual_params_all</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">quote_date</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># &quot;tau1&quot;, &quot;tau2&quot;, &quot;beta1&quot;, &quot;beta2&quot;, &quot;beta3&quot;, &quot;beta4&quot;</span>
<span class="c1"># params0 = np.array([1.0, 10.0, 3.0, 3.0, 3.0, 3.0])</span>
<span class="n">params0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.989721</span><span class="p">,</span> <span class="mf">9.955324</span><span class="p">,</span> <span class="mf">3.685087</span><span class="p">,</span> <span class="mf">1.579927</span><span class="p">,</span> <span class="mf">3.637107</span><span class="p">,</span> <span class="mf">9.814584</span><span class="p">])</span>
<span class="c1"># params0 = np.array([1.0, 1.0, 0.001, 0.001, 0.001, 0.001])</span>

<span class="n">params_star</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">quote_date</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">params0</span><span class="p">)</span>

<span class="c1">## Visualize the fit</span>
<span class="c1"># gsw2006_yield_curve.plot_spot_curve(params_star)</span>
<span class="c1"># gsw2006_yield_curve.plot_spot_curve(actual_params)</span>

<span class="n">price_comparison</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">compare_fit</span><span class="p">(</span>
    <span class="n">quote_date</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">params_star</span><span class="p">,</span> <span class="n">actual_params</span><span class="p">,</span> <span class="n">df</span>
<span class="p">)</span>

<span class="c1">## Assert that column is close to 0 for all CUSIPs</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">price_comparison</span><span class="p">[</span><span class="s2">&quot;Predicted - Actual %&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">price_comparison</span><span class="p">[</span><span class="s2">&quot;Predicted - GSW %&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## Test Day 3</span>
<span class="n">quote_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;1990-06-05&quot;</span><span class="p">)</span>
<span class="c1"># Subset df_all to quote_date</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[</span><span class="n">df_all</span><span class="p">[</span><span class="s2">&quot;caldt&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">quote_date</span><span class="p">]</span>
<span class="n">actual_params</span> <span class="o">=</span> <span class="n">actual_params_all</span><span class="p">[</span><span class="n">actual_params_all</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">quote_date</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># &quot;tau1&quot;, &quot;tau2&quot;, &quot;beta1&quot;, &quot;beta2&quot;, &quot;beta3&quot;, &quot;beta4&quot;</span>
<span class="c1"># params0 = np.array([1.0, 10.0, 3.0, 3.0, 3.0, 3.0])</span>
<span class="n">params0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.989721</span><span class="p">,</span> <span class="mf">9.955324</span><span class="p">,</span> <span class="mf">3.685087</span><span class="p">,</span> <span class="mf">1.579927</span><span class="p">,</span> <span class="mf">3.637107</span><span class="p">,</span> <span class="mf">9.814584</span><span class="p">])</span>
<span class="c1"># params0 = np.array([1.0, 1.0, 0.001, 0.001, 0.001, 0.001])</span>

<span class="n">params_star</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">quote_date</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">params0</span><span class="p">)</span>

<span class="c1">## Visualize the fit</span>
<span class="c1"># gsw2006_yield_curve.plot_spot_curve(params_star)</span>
<span class="c1"># gsw2006_yield_curve.plot_spot_curve(actual_params)</span>

<span class="n">price_comparison</span> <span class="o">=</span> <span class="n">gsw2006_yield_curve</span><span class="o">.</span><span class="n">compare_fit</span><span class="p">(</span>
    <span class="n">quote_date</span><span class="p">,</span> <span class="n">df_all</span><span class="p">,</span> <span class="n">params_star</span><span class="p">,</span> <span class="n">actual_params</span><span class="p">,</span> <span class="n">df</span>
<span class="p">)</span>

<span class="c1">## Assert that column is close to 0 for all CUSIPs</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">price_comparison</span><span class="p">[</span><span class="s2">&quot;Predicted - Actual %&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">price_comparison</span><span class="p">[</span><span class="s2">&quot;Predicted - GSW %&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>The GSW yield curve methodology provides a robust framework for estimating the U.S. Treasury yield curve. By carefully implementing their filtering criteria and optimization approach, we can replicate their results with high accuracy. This implementation allows us to extend their analysis to current data and provides a foundation for various fixed-income applications.</p>
<p>Example: Model Performance
Our implementation typically achieves price errors below 0.02% compared to the official GSW yields, demonstrating the reliability of the replication.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./output"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="_01_CRSP_treasury_overview.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">CRSP Treasury Data Oveview</p>
      </div>
    </a>
    <a class="right-next"
       href="../lectures/Week7/overview_w7.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 7: Bloomberg and LSEG Datastream</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-nelson-siegel-svensson-model">The Nelson-Siegel-Svensson Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theoretical-foundations">Theoretical Foundations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-curve-fitting-approach">1. <strong>Static Curve-Fitting Approach</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absence-of-no-arbitrage-restrictions">2. <strong>Absence of No-Arbitrage Restrictions</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-dynamics-and-risk-premiums">3. <strong>Factor Dynamics and Risk Premiums</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contrast-with-arbitrage-free-extensions">4. <strong>Contrast with Arbitrage-Free Extensions</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#empirical-vs-theoretical-focus">5. <strong>Empirical vs. Theoretical Focus</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-filtering">Data Filtering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-steps">Implementation Steps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">1. Data Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cashflow-construction">2. Cashflow Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting">3. Model Fitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-and-validation">Testing and Validation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremy Bejarano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>